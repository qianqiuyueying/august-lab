# 可运行性验证基线规范

## 1. 目标与范围
- 目标：建立“前后端测试可跑完”的最小可验证基线
- 范围：本地开发环境（Windows）下的环境检查、后端测试、前端测试

## 2. 需求与业务规则
### 2.1 需求
- 必须执行环境检查脚本并确认输出可读
- 必须执行后端测试套件并记录结果
- 必须执行前端测试套件并记录结果
- 必须将“卡住/超时”的测试定位到具体用例

### 2.2 规则
- 单个测试用例无输出超过 120 秒视为卡住
- 卡住用例必须单独复现；仍卡住则停止并记录证据
- 不得跳过失败与错误；必须记录失败列表与关键错误信息
- 卡住用例允许加入最小诊断设置（如 `deadline`、降低 `max_examples`），但需记录

## 3. 数据模型
### 3.1 验证记录
- 字段：command, started_at, ended_at, status, summary, evidence_path
- status: PASS | FAIL | ERROR | HANG

## 4. 执行与证据
### 4.1 环境检查
- 命令：`python check_env.py`
- 若控制台乱码，使用：`$env:PYTHONIOENCODING="utf-8"; python check_env.py`

### 4.2 后端测试
- 命令：`python -m pytest tests/ -v`（`backend/`）
- 记录：失败数量、错误数量、首个失败堆栈

### 4.3 前端测试
- 单元测试命令：`npm run test`（`frontend/`）
- 属性测试命令：`python -m pytest -v`（`frontend/tests/`）
- 若卡住：对可疑用例使用 `-k` 单测复现

### 4.4 证据摘要
- `test_product_access_statistics_accuracy` 单测复现后 120 秒无输出，已判定为 HANG 并停止进程
- 已为该用例添加 `AUGUST_TEST_PROGRESS` 进度日志，便于定位卡住阶段
- 运行开启进度日志后仍未输出 `start`，推断卡在 Hypothesis 数据生成阶段

## 5. 完成标准
- 环境检查完成且输出可读
- 后端测试跑完并有明确结果（PASS/FAIL/ERROR）
- 前端测试跑完或明确标记卡住用例（HANG）
- 形成可继续排查的最小证据记录

## 6. 执行清单（同步更新）
- [x] 环境检查可运行且无乱码
- [x] 后端测试已执行并记录失败/错误
- [x] 前端单元测试已执行并记录结果
- [x] 前端属性测试已执行并定位卡住用例
- [x] 单测卡住用例已形成最小根因假设
- [ ] 失败/错误清单已对齐到具体规范条款
